<!-- -->
<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel de Confirmações</title>

<link rel="stylesheet" href="css/style.css">
</head>

<body>

<div class="page">

<div class="centro">

<div class="card-local">
<h3>Resumo de Presença</h3>

<p>Total respostas: <span id="total">0</span></p>
<p>Confirmados: <span id="confirmados">0</span></p>
<p>Acompanhantes: <span id="acompanhantes">0</span></p>

</div>

<div class="card-local">
<h3>Lista completa</h3>

<iframe
src="LINK_PLANILHA_WEB"
width="100%"
height="500"
frameborder="0">
</iframe>

</div>

</div>

<div class="rodape">
<button class="botao-voltar" onclick="navegar('menu.html')">
Voltar
</button>
</div>

</div>

<script src="js/script.js"></script>

<script>
const csvURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQK4QnkA32CW7GjNqyzTFD8BSeb6zJDMpqr2nd8HO6CEFkE52G1sloZa5EIceLU-o0XP9WoxrFnj0YT/pub?gid=2065005834&single=true&output=csv ";

fetch(csvURL)
  .then(res => res.text())
  .then(text => {

    const linhas = text.split("\n").slice(1);

    let total = 0;
    let confirmados = 0;
    let acompanhantes = 0;

    linhas.forEach(linha => {
      if (!linha.trim()) return;

      total++;

      const colunas = linha.split(",");

      // ajuste conforme ordem do seu forms
      const resposta = colunas[2] || "";
      const qtd = parseInt(colunas[3]) || 0;

      if (resposta.toLowerCase().includes("sim"))
        confirmados++;

      acompanhantes += qtd;
    });

    document.getElementById("total").innerText = total;
    document.getElementById("confirmados").innerText = confirmados;
    document.getElementById("acompanhantes").innerText = acompanhantes;
  });
</script>

</body>
</html>
